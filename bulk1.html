<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transfer Certificate</title>
    <!-- Add these in <head> -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>
    /* Existing styles */
    @page {
        size: legal landscape;
        margin: 0;
    }
    body {
        font-family: "Times New Roman", serif;
        margin: 0;
        padding: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        background-color: #fff;
    }
    .container {
        width: 13.5in;
        height: 8in;
        padding: 20px;
        box-sizing: border-box;
        display: flex;
        gap: 20px;
        margin-left: 1in;
    }
    .container {
    position: relative;
    overflow: hidden;
}

.container::before {
    content: "Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School Jalalpur MV School";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    padding: 20px;
    font-size: 20px;
    color: rgba(128, 128, 128, 0.2);
    pointer-events: none;
    z-index: -1;
    transform: rotate(0deg);
    white-space: normal;
    align-items: left;
    justify-content: center;
    text-align: left;
    line-height: 1;
}
    .column {
        padding: 10px;
    }
    .small {
        font-size: 80%;
        width: 40%;
    }
    .large {
        width: 60%;
    }
    h2, h3 {
        text-align: center;
        text-transform: uppercase;
        margin-bottom: 5px;
    }
    .sub-info {
        text-align: center;
        font-size: 14px;
        font-weight: bold;
        margin-top: 0px;
        margin-bottom: 5px;
    }
    .info {
        margin-bottom: 5px;
    }
    .content {
        text-align: justify;
        line-height: 1.4;
    }
    .signature {
        margin-top: 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    .signature div {
        text-align: center;
        width: 30%;
    }
    .signature div p {
        margin: 2px 0;
    }
    .info-row {
        display: flex;
        justify-content: space-between;
    }
    .divider {
        width: 2px;
        background: black;
        border-left: 2px dotted black;
        height: auto;
    }
    /* Remove or replace these styles */
    .print-button, .upload-button {
        position: absolute;
        top: 10px;
        right: 300px;
        padding: 10px 20px;
        background-color: blue;
        color: white;
        border: none;
        cursor: pointer;
    }
.nav-buttons {
    position: fixed;
    top: 20px;
    right: 20px;
    display: flex;
    gap: 15px;
    z-index: 1000;
}

.nav-buttons button {
    padding: 8px 16px;
    font-size: 14px;
    background-color: #1e40af;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    box-shadow: 2px 2px 5px rgba(0,0,0,0.2);
    transition: background-color 0.3s ease;
}

.nav-buttons button:hover {
    background-color: #1e3a8a;
}

.nav-buttons button:disabled {
    background-color: #9ca3af;
    cursor: not-allowed;
}


    .date-place-container {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        gap: 2px;
    }
    input[type="text"] {
        width: auto;
        min-width: 50px;
        max-width: 100%;
        border: 1px solid #000;
    }
    input[type="text"]:focus {
        outline: none;
        border-bottom: 2px solid blue;
    }
    select {
        max-width: 100%;
    }

    @media print {
        input.data-input {
            display: none; /* Hide inputs */
        }
        span {
            display: inline-block;
        }
        input[type="text"],
        input[type="date"],
        input[type="checkbox"] {
            border: none;
            outline: none;
            background: transparent;
        }
        .print-button, .upload-button {
            display: none;
        }
        select {
            border: none;
            background: transparent;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
        }
    }
    @media print {
    .prev-student,
    .next-student,
    .pdf-button,
    .print-button,
    .upload-button,
    .nav-buttons {
        display: none !important;
    }

    div[style*="position: fixed"] {
        display: none !important;
    }
}
</style>
<style>
        #mismatchWarning {
            position: fixed;
            top: 10px;
            right: 10px;
            background-color: orange;
            color: white;
            padding: 10px;
            border-radius: 5px;
            display: none;
            z-index: 1000;
        }
        @media print {
            @page {
                size: legal landscape;
                margin: 0;
            }

            .container {
                width: 13.5in !important;
                height: 8in !important;
                page-break-after: always;
            }
        }
    </style>
</head>
<body>
<div id="mismatchWarning">Some dropdown values from Excel didn't match available options and were left blank.</div>
    <div class="nav-buttons">
    <button class="prev-student" onclick="showPreviousStudent()">Previous</button>
    <button class="next-student" onclick="showNextStudent()">Next</button>
    <button class="print-button" onclick="prepareForPrint()">Print</button>
    <button class="pdf-button" onclick="saveAllAsPDF()">Save as PDF</button>
</div>
    <div class="container" id="tcContainer">
        <div class="column small">
            <h2>Jalalpur MV School</h2>
            <p class="sub-info">P.O.- Jalalpur, District- Cachar, Assam<br>U-DISE: 18210108702 | Estd. 1942</p>
            <div class="info"><strong>Adm. No.:</strong> <input type="text" class="data-input" data-field="admno"></div>
            <div class="info"><strong>Unique Id:</strong> <input type="text" class="data-input" data-field="uniqueid"></div>
            <div class="info"><strong>Book No.:</strong> <input type="text" class="data-input" data-field="bookno"></div>
            <div class="info"><strong>SL No.:</strong> <input type="text" class="data-input" data-field="slno"></div>
            <div class="info"><strong>PEN No.:</strong> <input type="text" class="data-input" data-field="penno"></div>
          <h3>Transfer/Leaving Certificate</h3>
        <p class="content">This is to certify that <input type="text" class="data-input" data-field="studentname">, son of (father) <input type="text" class="data-input" data-field="fathername"> and (mother) <input type="text" class="data-input" data-field="mothername">, an inhabitant of village <input type="text" class="data-input" data-field="village">
,P.O <b>Jalalpur</b>, P.S. <b>Kalain</b>, District-<b>Cachar</b> was a student of class <select data-field="previousclass">
    <option value="I">I</option>
    <option value="II">II</option>
    <option value="III">III</option>
    <option value="IV">IV</option>
    <option value="V">V</option>
    <option value="VI">VI</option>
    <option value="VII">VII</option>
    <option value="VIII">VIII</option>
</select>.<select data-field="choice1">
         <option value="He">He</option>
        <option value="She">She</option></select> <select data-field="choice2">
         <option value="had">had</option>
        <option value="had not">had not</option></select> passed the final Evaluation/Examination and <select data-field="choice3">
         <option value="promoted to">promoted to</option>
        <option value="detained in">detained in</option></select> to class <select data-field="nextclass">
    <option value="I">I</option>
    <option value="II">II</option>
    <option value="III">III</option>
    <option value="IV">IV</option>
    <option value="V">V</option>
    <option value="VI">VI</option>
    <option value="VII">VII</option>
    <option value="VIII">VIII</option>
    <option value="IX">IX</option>
</select>
 & left the Jalalpur MV School on <input type="date" class="leftjalalpurdate">.<select data-field="choice4">
         <option value="His">His</option>
        <option value="Her">Her</option></select> date of birth is <input type="date" class="dob" data-field="dob"> as per the birth date recorded in the admission register.</p>
<br>
            <h3>Reason of Leaving</h3>
            <ul>
                <li><input type="checkbox" data-field="reason" value="unavoidable change of residence"> Unavoidable change of residence</li>
                <li><input type="checkbox" data-field="reason" value="completion of school course"> Completion of school course</li>
                <li><input type="checkbox" data-field="reason" value="ill health"> Ill health</li>
                <li><input type="checkbox" data-field="reason" value="minor reasons"> Minor reasons</li>
            </ul>
<br>
            <div class="signature">
                <div class="date-place-container" style="display: flex; flex-direction: column; align-items: flex-start;">
                    <p><strong>Place:</strong><b> Jalalpur </b></p>
                    <p><strong>Date:</strong> <input type="date" class="date2"></p>
                </div>
                <div>
                    <p><strong>Head Master</strong></p>
                    <p>Jalalpur MV School</p>
                    <p>Cachar, Assam</p>
                </div>
            </div>

        </div>

        <div class="divider"></div>
        <div class="column large">
            <h2>Jalalpur MV School</h2>
            <p class="sub-info">P.O.- Jalalpur, District- Cachar, Assam<br>U-DISE: 18210108702 | Estd. 1942</p>
            <div class="info-row">
                <div class="info"><strong>Adm. No.:</strong> <input type="text" class="data-input" data-field="admno"></div>
                <div class="info"><strong>Book No.:</strong> <input type="text" class="data-input" data-field="bookno"></div>
              
            </div>
          <div class="info-row">
                <div class="info"><strong>Unique Id:</strong> <input type="text" class="data-input" data-field="uniqueid"></div>
                <div class="info"><strong>SL No.:</strong> <input type="text" class="data-input" data-field="slno"></div>
            </div>
          <div class="info-row">
                <div class="info"><strong>PEN No.:</strong> <input type="text" class="data-input" data-field="penno"></div>
            </div>
            <h3>Transfer/Leaving Certificate</h3>
           <p class="content">This is to certify that <input type="text" class="data-input" data-field="studentname">, son of (father) <input type="text" class="data-input" data-field="fathername"> and (mother) <input type="text" class="data-input" data-field="mothername">, an inhabitant of village <input type="text" class="data-input" data-field="village">
,P.O <b>Jalalpur</b>, P.S. <b>Kalain</b>, District-<b>Cachar</b> was a student of class <select data-field="previousclass">
    <option value="I">I</option>
    <option value="II">II</option>
    <option value="III">III</option>
    <option value="IV">IV</option>
    <option value="V">V</option>
    <option value="VI">VI</option>
    <option value="VII">VII</option>
    <option value="VIII">VIII</option>
</select>.<select data-field="choice1">
         <option value="He">He</option>
        <option value="She">She</option></select> <select data-field="choice2">
         <option value="had">had</option>
        <option value="had not">had not</option></select> passed the final Evaluation/Examination and <select data-field="choice3">
         <option value="promoted to">promoted to</option>
        <option value="detained in">detained in</option></select> to class <select data-field="nextclass">
    <option value="I">I</option>
    <option value="II">II</option>
    <option value="III">III</option>
    <option value="IV">IV</option>
    <option value="V">V</option>
    <option value="VI">VI</option>
    <option value="VII">VII</option>
    <option value="VIII">VIII</option>
    <option value="IX">IX</option>
</select> & left the Jalalpur MV School on <input type="date" class="leftjalalpurdate">.<select data-field="choice4">
         <option value="His">His</option>
        <option value="Her">Her</option></select> date of birth is <input type="date" class="dob" data-field="dob"> as per the birth date recorded in the admission register.</p>

           <br></br>
          <h4>Reason of Leaving</h4>
            <ul>
                <li><input type="checkbox" data-field="reason" value="unavoidable change of residence"> Unavoidable change of residence</li>
                <li><input type="checkbox" data-field="reason" value="completion of school course"> Completion of school course</li>
                <li><input type="checkbox" data-field="reason" value="ill health"> Ill health</li>
                <li><input type="checkbox" data-field="reason" value="minor reasons"> Minor reasons</li>
            </ul>
          <br></br>
          <div class="signature">
                <div class="date-place-container">
                    <p><strong>Place:</strong><b> Jalalpur</b></p>
                    <p><strong>Date:</strong> <input type="date" class="date2"></p>
                </div>
                <div>
                    <p><strong>Head Master</strong></p>
                    <p>Jalalpur MV School</p>
                    <p>Cachar, Assam</p>
                </div>
            </div>
        </div>
    </div>



        </div>
    </div>
<script>
    let currentIndex = 0;
    let bulkStudents = JSON.parse(sessionStorage.getItem("bulkStudents") || "[]");

    function showStudent(index) {
        if (index >= 0 && index < bulkStudents.length) {
            currentIndex = index;
            populateForm(bulkStudents[currentIndex]);

            document.querySelector('.prev-student').disabled = currentIndex === 0;
            document.querySelector('.next-student').disabled = currentIndex === bulkStudents.length - 1;
        }
    }

    function showPreviousStudent() {
        if (currentIndex > 0) {
            showStudent(currentIndex - 1);
        }
    }

    function showNextStudent() {
        if (currentIndex < bulkStudents.length - 1) {
            showStudent(currentIndex + 1);
        }
    }

    document.addEventListener("DOMContentLoaded", function () {
        if (bulkStudents.length > 0) {
            showStudent(0);
        } else {
            console.warn("No student data found");
        }
    });

    function formatDate(dateStr) {
        if (!dateStr) return "";
        try {
            if (typeof dateStr === 'number') {
                const date = new Date((dateStr - 25569) * 86400 * 1000);
                return date.toISOString().split('T')[0];
            }
            if (typeof dateStr === 'string') {
                const parts = dateStr.split(/[-/]/);
                if (parts.length === 3) {
                    if (parts[0].length <= 2 && parseInt(parts[0]) <= 31) {
                        return `${parts[2]}-${parts[1].padStart(2, '0')}-${parts[0].padStart(2, '0')}`;
                    }
                }
                const date = new Date(dateStr);
                if (!isNaN(date.getTime())) {
                    return date.toISOString().split('T')[0];
                }
            }
            return "";
        } catch (e) {
            console.error("Date parsing error:", e, "for value:", dateStr);
            return "";
        }
    }

    function populateForm(studentData) {
        let mismatch = false;
        Object.entries(studentData).forEach(([key, value]) => {
            if (!value || value === "NaN" || value === null) value = "";
            document.querySelectorAll(`[data-field="${key.toLowerCase()}"]`).forEach(input => {
                if (input.tagName === 'SELECT') {
                    if ([...input.options].some(opt => opt.value === value)) {
                        input.value = value;
                    } else {
                        input.value = "";
                        mismatch = true;
                    }
                } else {
                    input.value = value;
                }
            });
        });

        ["dob", "leftjalalpurdate", "date2"].forEach(field => {
            if (studentData[field]) {
                const formattedDate = formatDate(studentData[field]);
                document.querySelectorAll(`input[type="date"][data-field="${field}"], input[type="date"].${field}`).forEach(input => {
                    input.value = formattedDate;
                });
            }
        });

        const selectFields = ["choice1", "choice2", "choice3", "choice4", "previousclass", "nextclass"];
        selectFields.forEach(field => {
            if (studentData[field]) {
                document.querySelectorAll(`select[data-field="${field}"]`).forEach(select => {
                    if ([...select.options].some(opt => opt.value === studentData[field])) {
                        select.value = studentData[field];
                    } else {
                        select.value = "";
                        mismatch = true;
                    }
                });
            }
        });

        // Set checkboxes based on label text (same as page3.html)
        document.querySelectorAll('input[type="checkbox"][data-field="reason"]').forEach(checkbox => {
            checkbox.checked = false;
        });

        if (studentData.reason) {
            const reasonsArray = studentData.reason.toLowerCase().split(/[,;]/).map(r => r.trim());
            document.querySelectorAll('input[type="checkbox"][data-field="reason"]').forEach(checkbox => {
                let labelText = checkbox.parentNode.textContent.trim().toLowerCase();
                if (reasonsArray.some(r => labelText.includes(r))) {
                    checkbox.checked = true;
                }
            });
        }

        document.querySelectorAll('input, select').forEach(element => {
            element.disabled = false;
        });

        if (mismatch) {
            document.getElementById('mismatchWarning').style.display = 'block';
            setTimeout(() => {
                document.getElementById('mismatchWarning').style.display = 'none';
            }, 5000);
        }
    }
function prepareForPrint() {
    // Replace inputs with underlined spans
    document.querySelectorAll(".data-input").forEach(input => {
        const span = document.createElement("span");
        span.textContent = input.value || "_________________";
        span.style.borderBottom = "1px solid black";
        span.style.display = "inline-block";
        span.style.minWidth = "100px";
        input.style.display = "none";
        input.parentNode.insertBefore(span, input);
    });
    setTimeout(() => {
        window.print();
        restoreAfterPrint();
    }, 100);
}

function restoreAfterPrint() {
    document.querySelectorAll(".data-input").forEach(input => {
        input.style.display = "";
        if (input.previousSibling && input.previousSibling.tagName === "SPAN") {
            input.previousSibling.remove();
        }
    });
}

function applyPDFStyles() {
    document.querySelectorAll('input[type="text"], input[type="date"], select').forEach(input => {
        input.style.border = "none";
        input.style.background = "transparent";
        input.style.outline = "none";
        input.style.pointerEvents = "none"; // Prevent accidental clicks
    });
}

function restorePDFStyles() {
    document.querySelectorAll('input[type="text"], input[type="date"], select').forEach(input => {
        input.style.border = "";
        input.style.background = "";
        input.style.outline = "";
        input.style.pointerEvents = "";
    });
}



     async function saveAllAsPDF() {
    const originalIndex = currentIndex;
    const { jsPDF } = window.jspdf;
    const pdf = new jsPDF({
        orientation: 'landscape',
        unit: 'in',
        format: 'legal'
    });

    document.querySelectorAll('.nav-buttons button').forEach(btn => btn.disabled = true);

    for (let i = 0; i < bulkStudents.length; i++) {
        populateForm(bulkStudents[i]);
        await new Promise(resolve => setTimeout(resolve, 500)); // Wait for data

        applyPDFStyles(); // Apply print-like styles!

        const element = document.getElementById('tcContainer');
        const canvas = await html2canvas(element, { scale: 2 });
        const imgData = canvas.toDataURL('image/jpeg', 1.0);
        const imgProps = pdf.getImageProperties(imgData);
        const pdfWidth = pdf.internal.pageSize.getWidth();
        const pdfHeight = (imgProps.height * pdfWidth) / imgProps.width;

        if (i !== 0) pdf.addPage();
        pdf.addImage(imgData, 'JPEG', 0, 0, pdfWidth, pdfHeight);

        restorePDFStyles(); // Reset back
    }

    pdf.save('All_TCs.pdf');
    showStudent(originalIndex);
    document.querySelectorAll('.nav-buttons button').forEach(btn => btn.disabled = false);
}

         </script>
</body>
</html>
